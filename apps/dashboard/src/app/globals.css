@tailwind base;
@tailwind components;
@tailwind utilities;

/*
 * Pravado Design System v3 â€” AI-Native Command Center
 * Canonical source: docs/canon/DS_v3_1_EXPRESSION.md
 * Dark mode is the authoritative default
 */

@layer base {
  :root {
    /* DS v3 Core Palette */
    --dark-bg: #0A0A0F;
    --dark-card: #13131A;
    --dark-border: #1F1F28;
    --cyber-blue: #00D9FF;
    --electric-purple: #A855F7;

    /* Base Neutrals (DS v3 aligned) */
    --slate-0: #0A0A0F;
    --slate-1: #0E0E14;
    --slate-2: #13131A;
    --slate-3: #19191F;
    --slate-4: #1F1F28;
    --slate-5: #2A2A35;
    --slate-6: #3D3D4A;
    --white-0: #E8E8ED;

    /* Brand Accents (DS v3) */
    --brand-iris: #A855F7;
    --brand-cyan: #00D9FF;
    --brand-teal: #14B8A6;
    --brand-magenta: #D946EF;
    --brand-amber: #F59E0B;

    /* Semantic Colors (DS v3 with 20% opacity variants) */
    --semantic-info: #00D9FF;
    --semantic-success: #22C55E;
    --semantic-warning: #EAB308;
    --semantic-danger: #EF4444;

    /* Gradients (DS v3) */
    --grad-hero: linear-gradient(135deg, #A855F7 0%, #00D9FF 50%, #D946EF 100%);
    --grad-warm: linear-gradient(145deg, #A855F7 0%, #F59E0B 100%);

    /* Page/Panel Semantic Aliases */
    --page-bg: var(--dark-bg);
    --panel-bg: var(--dark-card);
    --text: var(--white-0);
    --muted: var(--slate-6);
    --border-subtle: var(--dark-border);

    /* Radii */
    --radius-xs: 4px;
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-2xl: 20px;
    --radius: var(--radius-lg);

    /* Elevation/Shadows (DS v3 - subtle, premium) */
    --elev-0: none;
    --elev-1: 0 1px 2px rgba(0, 0, 0, 0.3);
    --elev-2: 0 4px 12px rgba(0, 0, 0, 0.4);
    --elev-3: 0 8px 24px rgba(0, 0, 0, 0.5);
    --shadow-panel: var(--elev-3);

    /* Motion (DS v3 - premium, subtle) */
    --motion-duration-xs: 100ms;
    --motion-duration-sm: 150ms;
    --motion-duration-md: 250ms;
    --motion-duration-lg: 400ms;
    --motion-ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
    --motion-ease-emphatic: cubic-bezier(0.16, 1, 0.3, 1);

    /* Z-Index Scale */
    --z-base: 0;
    --z-nav: 30;
    --z-modal: 40;
    --z-popover: 50;
    --z-toast: 60;

    /* Data Viz Gridlines */
    --viz-gridline: rgba(234, 242, 247, 0.08);
    --viz-axis-label: rgba(234, 242, 247, 0.72);

    /* Legacy shadcn compatibility (mapped to Pravado tokens) */
    --background: 213 39% 6%;
    --foreground: 206 47% 94%;
    --card: 215 33% 10%;
    --card-foreground: 206 47% 94%;
    --popover: 215 33% 10%;
    --popover-foreground: 206 47% 94%;
    --primary: 239 93% 70%;
    --primary-foreground: 213 39% 6%;
    --secondary: 213 26% 17%;
    --secondary-foreground: 206 47% 94%;
    --muted-hsl: 213 26% 17%;
    --muted-foreground: 211 24% 32%;
    --accent: 213 26% 17%;
    --accent-foreground: 206 47% 94%;
    --destructive: 0 70% 71%;
    --destructive-foreground: 206 47% 94%;
    --border: 213 26% 17%;
    --input: 213 26% 17%;
    --ring: 187 100% 61%;
  }

  /* Dark mode is default - explicit class for clarity */
  .dark,
  [data-theme="dark"] {
    /* Same as root - dark is default */
  }

  /* Light mode (optional - auto-derives) */
  .light,
  [data-theme="light"] {
    --page-bg: #F7FAFD;
    --panel-bg: #FFFFFF;
    --text: #0B0F14;
    --muted: #5A6B7D;
    --border-subtle: rgba(0, 0, 0, 0.08);

    --background: 210 50% 98%;
    --foreground: 213 39% 6%;
    --card: 0 0% 100%;
    --card-foreground: 213 39% 6%;
    --popover: 0 0% 100%;
    --popover-foreground: 213 39% 6%;
    --primary: 239 93% 70%;
    --primary-foreground: 0 0% 100%;
    --secondary: 210 40% 96%;
    --secondary-foreground: 213 39% 6%;
    --muted-hsl: 210 40% 96%;
    --muted-foreground: 211 24% 45%;
    --accent: 210 40% 96%;
    --accent-foreground: 213 39% 6%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 239 93% 70%;
  }
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    /* Dark mode default */
    color-scheme: dark;
  }

  body {
    @apply bg-page text-text antialiased;
    font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, sans-serif;
  }

  /* Focus ring using brand-cyan per DS */
  *:focus-visible {
    @apply outline-none ring-2 ring-brand-cyan ring-offset-2 ring-offset-page;
  }
}

@layer components {
  /* AI Presence Dot - Idle */
  .ai-dot {
    @apply w-2 h-2 rounded-full;
    background-color: var(--slate-6);
  }

  /* AI Presence Dot - Analyzing (cyber-blue pulse) */
  .ai-dot-analyzing {
    @apply w-2 h-2 rounded-full;
    background-color: var(--cyber-blue);
    animation: ai-pulse 1400ms var(--motion-ease-standard) infinite;
  }

  /* AI Presence Dot - Generating (electric-purple) */
  .ai-dot-generating {
    @apply w-2 h-2 rounded-full;
    background-color: var(--electric-purple);
  }

  /* Panel Card (DS v3) */
  .panel-card {
    background-color: var(--dark-card);
    border: 1px solid var(--dark-border);
    @apply rounded-lg shadow-panel;
  }

  /* Auth Card (DS v3 - premium glass effect) */
  .auth-card {
    background-color: rgba(19, 19, 26, 0.85); /* --dark-card with 85% opacity */
    backdrop-filter: blur(12px);
    border: 1px solid var(--dark-border);
    @apply rounded-lg shadow-panel;
  }

  /* Primary Button (DS v3 - electric-purple accent) */
  .btn-primary {
    @apply inline-flex items-center justify-center px-4 py-2.5 text-sm font-medium rounded-md;
    background-color: var(--electric-purple);
    color: white;
    transition: all var(--motion-duration-sm) var(--motion-ease-standard);
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }
  .btn-primary:hover:not(:disabled) {
    background-color: rgba(168, 85, 247, 0.85); /* --electric-purple at 85% */
    transform: translateY(-1px);
  }
  .btn-primary:active:not(:disabled) {
    background-color: rgba(168, 85, 247, 0.75); /* --electric-purple at 75% */
    transform: translateY(0);
  }

  /* Secondary Button (DS v3) */
  .btn-secondary {
    @apply inline-flex items-center justify-center px-4 py-2.5 text-sm font-medium rounded-md;
    background-color: var(--dark-card);
    color: var(--white-0);
    border: 1px solid var(--dark-border);
    transition: all var(--motion-duration-sm) var(--motion-ease-standard);
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }
  .btn-secondary:hover:not(:disabled) {
    background-color: var(--slate-4);
    border-color: var(--slate-5);
  }

  /* Ghost Button (DS v3) */
  .btn-ghost {
    @apply inline-flex items-center justify-center px-4 py-2.5 text-sm font-medium rounded-md;
    background-color: transparent;
    color: var(--slate-6);
    transition: all var(--motion-duration-sm) var(--motion-ease-standard);
  }
  .btn-ghost:hover {
    color: var(--white-0);
    background-color: rgba(31, 31, 40, 0.5); /* --dark-border at 50% */
  }

  /* OAuth Button (DS v3 - premium styling) */
  .btn-oauth {
    @apply inline-flex items-center justify-center gap-3 px-4 py-3 w-full;
    @apply text-sm font-medium rounded-md;
    background-color: var(--slate-3);
    color: var(--white-0);
    border: 1px solid var(--dark-border);
    transition: all var(--motion-duration-sm) var(--motion-ease-standard);
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }
  .btn-oauth:hover:not(:disabled) {
    background-color: var(--slate-4);
    border-color: rgba(0, 217, 255, 0.3); /* --cyber-blue at 30% */
  }

  /* Magic Link Button (DS v3 - cyber-blue accent) */
  .btn-magic-link {
    @apply inline-flex items-center justify-center gap-3 px-4 py-3;
    @apply text-sm font-medium rounded-md;
    color: var(--cyber-blue);
    background-color: transparent;
    border: 1px solid rgba(0, 217, 255, 0.3); /* --cyber-blue at 30% */
    transition: all var(--motion-duration-sm) var(--motion-ease-standard);
    @apply disabled:opacity-50 disabled:cursor-not-allowed;
  }
  .btn-magic-link:hover:not(:disabled) {
    background-color: rgba(0, 217, 255, 0.08); /* --cyber-blue at 8% */
    border-color: rgba(0, 217, 255, 0.5); /* --cyber-blue at 50% */
  }

  /* Input Field (DS v3) */
  .input-field {
    @apply w-full px-4 py-3 text-sm rounded-md;
    background-color: var(--slate-3);
    color: var(--white-0);
    border: 1px solid var(--dark-border);
    transition: all var(--motion-duration-sm) var(--motion-ease-standard);
  }
  .input-field::placeholder {
    color: var(--slate-6);
  }
  .input-field:focus {
    outline: none;
    border-color: var(--cyber-blue);
    box-shadow: 0 0 0 2px rgba(0, 217, 255, 0.15); /* --cyber-blue at 15% */
  }

  /* Error Alert (DS v3 - critical color) */
  .alert-error {
    @apply rounded-md p-4 text-sm;
    color: var(--semantic-danger);
    background-color: rgba(239, 68, 68, 0.1); /* --semantic-danger at 10% */
    border: 1px solid rgba(239, 68, 68, 0.2); /* --semantic-danger at 20% */
  }

  /* Success Alert (DS v3) */
  .alert-success {
    @apply rounded-md p-4 text-sm;
    color: var(--semantic-success);
    background-color: rgba(34, 197, 94, 0.1); /* --semantic-success at 10% */
    border: 1px solid rgba(34, 197, 94, 0.2); /* --semantic-success at 20% */
  }

  /* Info Alert (DS v3 - cyber-blue) */
  .alert-info {
    @apply rounded-md p-4 text-sm;
    color: var(--cyber-blue);
    background-color: rgba(0, 217, 255, 0.08); /* --cyber-blue at 8% */
    border: 1px solid rgba(0, 217, 255, 0.2); /* --cyber-blue at 20% */
  }

  /* Warning Alert (DS v3) */
  .alert-warning {
    @apply rounded-md p-4 text-sm;
    color: var(--semantic-warning);
    background-color: rgba(234, 179, 8, 0.1); /* --semantic-warning at 10% */
    border: 1px solid rgba(234, 179, 8, 0.2); /* --semantic-warning at 20% */
  }

  /* Confidence Badge (DS v3) */
  .badge-confidence-high {
    @apply text-xs px-2 py-0.5 rounded-full;
    color: var(--cyber-blue);
    background-color: rgba(0, 217, 255, 0.1);
  }

  .badge-confidence-medium {
    @apply text-xs px-2 py-0.5 rounded-full;
    color: var(--electric-purple);
    background-color: rgba(168, 85, 247, 0.1);
  }

  .badge-confidence-low {
    @apply text-xs px-2 py-0.5 rounded-full;
    background-color: var(--slate-5);
    color: var(--slate-6);
  }
}

@layer utilities {
  /* Gradient text utility */
  .text-gradient-hero {
    background: var(--grad-hero);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
  }

  /* Shimmer animation for AI thinking state */
  .shimmer {
    background: linear-gradient(
      110deg,
      transparent 0%,
      var(--brand-cyan) 50%,
      transparent 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1600ms infinite;
  }

  /*
   * DS v3 Typography Tokens
   * These enforce minimum readable sizes across the dashboard.
   * Use these semantic classes instead of arbitrary text sizes.
   *
   * text-body   - Primary content text (>=14px, 0.875rem)
   * text-meta   - Secondary/metadata text (>=12px, but avoid for large blocks)
   * text-micro  - Labels, badges (ONLY with uppercase + tracking + semibold)
   * text-heading-* - Headings at various levels
   */

  /* Body text: Primary readable content (>=14px) */
  .text-body {
    font-size: 0.875rem; /* 14px */
    line-height: 1.5;
    font-weight: 400;
  }

  .text-body-lg {
    font-size: 1rem; /* 16px */
    line-height: 1.5;
    font-weight: 400;
  }

  /* Meta text: Secondary info, timestamps, metadata (>=12px) */
  .text-meta {
    font-size: 0.75rem; /* 12px */
    line-height: 1.4;
    font-weight: 400;
    color: var(--slate-6);
  }

  /* Micro text: ONLY for uppercase labels/badges */
  .text-micro {
    font-size: 0.6875rem; /* 11px */
    line-height: 1.3;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  /* Heading tokens */
  .text-heading-xl {
    font-size: 1.5rem; /* 24px */
    line-height: 1.25;
    font-weight: 600;
  }

  .text-heading-lg {
    font-size: 1.25rem; /* 20px */
    line-height: 1.3;
    font-weight: 600;
  }

  .text-heading-md {
    font-size: 1.125rem; /* 18px */
    line-height: 1.35;
    font-weight: 600;
  }

  .text-heading-sm {
    font-size: 1rem; /* 16px */
    line-height: 1.4;
    font-weight: 600;
  }

  /* Number/stat display */
  .text-stat {
    font-size: 1.5rem; /* 24px */
    line-height: 1;
    font-weight: 700;
    font-feature-settings: 'tnum';
  }

  .text-stat-lg {
    font-size: 2rem; /* 32px */
    line-height: 1;
    font-weight: 700;
    font-feature-settings: 'tnum';
  }
}

/* Keyframes */
@keyframes ai-pulse {
  0%, 100% {
    opacity: 0.8;
    transform: scale(0.98);
  }
  50% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes shimmer {
  0% {
    background-position: 200% 0;
  }
  100% {
    background-position: -200% 0;
  }
}

/* Phase 6A.6: Micro-interaction keyframes */
@keyframes fadeOut {
  0% {
    opacity: 1;
  }
  100% {
    opacity: 0;
  }
}

@keyframes scaleIn {
  0% {
    opacity: 0;
    transform: scale(0.8);
  }
  100% {
    opacity: 1;
    transform: scale(1);
  }
}

@keyframes checkmark-draw {
  0% {
    stroke-dashoffset: 24;
  }
  100% {
    stroke-dashoffset: 0;
  }
}

/* Prefers reduced motion */
@media (prefers-reduced-motion: reduce) {
  .ai-dot-analyzing,
  .shimmer {
    animation: none;
  }
}
